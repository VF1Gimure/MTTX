schema: '2.0'
stages:
  load_data:
    cmd: python pipelines/src/load_data.py data/raw/KnightX_exp_dataset data/processed/train_data.pt
    deps:
    - path: data/raw
      hash: md5
      md5: 85a754daf6d545eea6579741581f4dde.dir
      size: 1169603990
      nfiles: 5006
    - path: pipelines/src/load_data.py
      hash: md5
      md5: 584d24811d59a25b5ff7b34eb61ce9d2
      size: 1682
    - path: pipelines/utils/transformers_setup.py
      hash: md5
      md5: b4eee6d54525b20f76c5136b2cd21a31
      size: 565
    outs:
    - path: data/processed/train_data.pt
      hash: md5
      md5: 02f4978f91dd9622ba376ea752efe52f
      size: 940
  load.compute_mean_std:
    cmd: python pipelines/utils/compute_mean_std.py mean_std.csv
    deps:
    - path: data/raw/KnightX_exp_dataset
      hash: md5
      md5: c1b6a3f3f6d58c547ad5ef52d024d9b9.dir
      size: 1011643113
      nfiles: 4681
    - path: pipelines/utils/compute_mean_std.py
      hash: md5
      md5: d80e00135933b998fec4ab253cbaed79
      size: 703
    outs:
    - path: data/processed/mean_std.csv
      hash: md5
      md5: 6a939e13ec162214a35c86de3429ba4b
      size: 117
  load.train_data:
    cmd: python pipelines/src/load_data.py mean_std.csv train_data.pt
    deps:
    - path: pipelines/src/load_data.py
      hash: md5
      md5: b90e1cb88d96b57325c52855377f4981
      size: 1360
    outs:
    - path: data/processed/train_data.pt
      hash: md5
      md5: 9b32f7d5bacb0b5da62d9a804349ee25
      size: 81438855030
  preprocess.extract_boxes:
    cmd: python pipelines/src/preprocess_extract_boxes.py train_data.pt mtcnn_boxes.pkl
      mean_std.csv
    deps:
    - path: data/processed/mean_std.csv
      hash: md5
      md5: 6a939e13ec162214a35c86de3429ba4b
      size: 117
    - path: data/processed/train_data.pt
      hash: md5
      md5: 9b32f7d5bacb0b5da62d9a804349ee25
      size: 81438855030
    - path: pipelines/src/preprocess_extract_boxes.py
      hash: md5
      md5: d89ef829bdf4fa033b0f384550a58af5
      size: 1379
    outs:
    - path: data/processed/mtcnn_boxes.pkl
      hash: md5
      md5: 88b00d21fadf5e02b0be51c860d1ecd3
      size: 327509
  preprocess.filter_faces:
    cmd: python pipelines/src/preprocess_filter_faces.py mtcnn_boxes.pkl train_data.pt
      filtered_boxes.pkl filtered_angles.pkl
    deps:
    - path: data/processed/mtcnn_boxes.pkl
      hash: md5
      md5: 88b00d21fadf5e02b0be51c860d1ecd3
      size: 327509
    - path: data/processed/train_data.pt
      hash: md5
      md5: 9b32f7d5bacb0b5da62d9a804349ee25
      size: 81438855030
    - path: pipelines/src/preprocess_filter_faces.py
      hash: md5
      md5: 1d32f089ff45119aee5ad529d6f84fdf
      size: 1443
    outs:
    - path: data/processed/filtered_angles.pkl
      hash: md5
      md5: d1ceb09e7a1ba3004529a4c989821122
      size: 55380
    - path: data/processed/filtered_boxes.pkl
      hash: md5
      md5: c9ae3c70b720e98df904f6e1d32e872a
      size: 176378
  preprocess.refine_faces:
    cmd: python pipelines/src/preprocess_filter_loaded_data.py train_data.pt filtered_boxes.pkl
      filtered_angles.pkl train_data_filtered.pt
    deps:
    - path: data/processed/filtered_angles.pkl
      hash: md5
      md5: d1ceb09e7a1ba3004529a4c989821122
      size: 55380
    - path: data/processed/filtered_boxes.pkl
      hash: md5
      md5: c9ae3c70b720e98df904f6e1d32e872a
      size: 176378
    - path: data/processed/train_data.pt
      hash: md5
      md5: 9b32f7d5bacb0b5da62d9a804349ee25
      size: 81438855030
    - path: pipelines/src/preprocess_filter_loaded_data.py
      hash: md5
      md5: 4f84e50c1ca86b9d0ac0cdbfa9eb61d3
      size: 1285
    outs:
    - path: data/processed/train_data_filtered.pt
      hash: md5
      md5: 74f86ec8f470625170545c81e906203b
      size: 11463247366
  preprocess.apply_clahe_unsharp:
    cmd: python pipelines/src/preprocess_image.py train_data_filtered.pt train_data_clahe.pt
      mean_std.csv
    deps:
    - path: data/processed/mean_std.csv
      hash: md5
      md5: 6a939e13ec162214a35c86de3429ba4b
      size: 117
    - path: data/processed/train_data_filtered.pt
      hash: md5
      md5: 74f86ec8f470625170545c81e906203b
      size: 11463247366
    - path: pipelines/src/preprocess_image.py
      hash: md5
      md5: af19cfaa5d7a5bf9734516e9a51c89b4
      size: 1297
    outs:
    - path: data/processed/train_data_clahe.pt
      hash: md5
      md5: c4da83ba8b30a976dff4d08889bd4101
      size: 3821328932
  preprocess.extract_dlib_landmarks:
    cmd: python pipelines/src/preprocess_image_landmarks.py train_data_clahe.pt train_data_landmarked.pt
      mean_std.csv
    deps:
    - path: data/model/shape_predictor_68_face_landmarks.dat
      hash: md5
      md5: 73fde5e05226548677a050913eed4e04
      size: 99693937
    - path: data/processed/mean_std.csv
      hash: md5
      md5: 6a939e13ec162214a35c86de3429ba4b
      size: 117
    - path: data/processed/train_data_clahe.pt
      hash: md5
      md5: c4da83ba8b30a976dff4d08889bd4101
      size: 3821328932
    - path: pipelines/src/preprocess_image_landmarks.py
      hash: md5
      md5: 7131e7d8a0730180992c19aabbf690b8
      size: 1217
    outs:
    - path: data/processed/train_data_landmarked.pt
      hash: md5
      md5: dd53a9eac0f2d89bb937cd701706f660
      size: 3822071362
  preprocess.crop_resize_convert:
    cmd: python pipelines/src/preprocess.py train_data_landmarked.pt train_data_2channel_train.pt
      train_data_2channel_test.pt train_data_3channel_train.pt train_data_3channel_test.pt
    deps:
    - path: data/processed/train_data_landmarked.pt
      hash: md5
      md5: dd53a9eac0f2d89bb937cd701706f660
      size: 3822071362
    - path: pipelines/src/preprocess.py
      hash: md5
      md5: 74ec46c71ec37cd2e5ffd71767f38802
      size: 3293
    outs:
    - path: data/processed/train_data_2channel_test.pt
      hash: md5
      md5: cf583befd4f970dd82c936989c92a884
      size: 67084223
    - path: data/processed/train_data_2channel_train.pt
      hash: md5
      md5: 23476c00da28709c76137423c1a93ac6
      size: 267935402
    - path: data/processed/train_data_3channel_test.pt
      hash: md5
      md5: 7565ee1089643a12568efd5b59ffc028
      size: 100601791
    - path: data/processed/train_data_3channel_train.pt
      hash: md5
      md5: a3c4c62ecdcc6e8086e55e5c2ff08af5
      size: 401804970
  train:
    cmd: python pipelines/src/train.py train_data_2channel_train.pt model.pth
    deps:
    - path: data/processed/train_data_2channel_train.pt
      hash: md5
      md5: 23476c00da28709c76137423c1a93ac6
      size: 267935402
    - path: pipelines/src/train.py
      hash: md5
      md5: 62af64e2091b5bb43b1526e414b995ec
      size: 1656
    outs:
    - path: data/model/runs/model.pth
      hash: md5
      md5: a9a5c8d62bb34dc37918c65cb5329435
      size: 6694392
  evaluate:
    cmd: python pipelines/src/evaluate.py train_data_2channel_test.pt model.pth metrics.csv
      conf_matrix.pkl
    deps:
    - path: data/model/runs/model.pth
      hash: md5
      md5: a9a5c8d62bb34dc37918c65cb5329435
      size: 6694392
    - path: data/processed/train_data_2channel_test.pt
      hash: md5
      md5: cf583befd4f970dd82c936989c92a884
      size: 67084223
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0b6d3789102273802e65d570587e6588
      size: 3683
    outs:
    - path: data/processed/conf_matrix.pkl
      hash: md5
      md5: 2d31ef48e6ab254069a12d05c592a25a
      size: 664
    - path: data/processed/metrics.csv
      hash: md5
      md5: ca9789e829f5f6f5dcce9e77b58780d0
      size: 458
  train_vgg16:
    cmd: python pipelines/src/train.py train_data_3channel_train.pt vgg16
    deps:
    - path: data/processed/train_data_3channel_train.pt
      hash: md5
      md5: a3c4c62ecdcc6e8086e55e5c2ff08af5
      size: 401804970
    - path: pipelines/src/train.py
      hash: md5
      md5: e91dd00e1696b3bbb90f29a63a186096
      size: 5860
    outs:
    - path: data/model/runs/vgg16.pth
      hash: md5
      md5: af9a0a29fbf2982767e552886e398aa7
      size: 537182638
  train_resnet:
    cmd: python pipelines/src/train_resnet.py train_data_3channel_train.pt resnet18.pth
    deps:
    - path: data/processed/train_data_3channel_train.pt
      hash: md5
      md5: a3c4c62ecdcc6e8086e55e5c2ff08af5
      size: 401804970
    - path: pipelines/src/train_resnet.py
      hash: md5
      md5: c21362ca10a7634e9558c0357819c036
      size: 1893
    outs:
    - path: data/model/runs/resnet18.pth
      hash: md5
      md5: 01b88ed4fbc1155c359d9f149856a065
      size: 44801020
  train_vit:
    cmd: python pipelines/src/train.py train_data_3channel_train.pt vit vit.pth
    deps:
    - path: data/processed/train_data_3channel_train.pt
      hash: md5
      md5: a3c4c62ecdcc6e8086e55e5c2ff08af5
      size: 401804970
    - path: pipelines/src/train.py
      hash: md5
      md5: e91dd00e1696b3bbb90f29a63a186096
      size: 5860
    outs:
    - path: data/model/runs/vit.pth
      hash: md5
      md5: da97b99889bc7fc0bed7adfbd7356c26
      size: 343268370
  train_efficientnet:
    cmd: python pipelines/src/train.py train_data_3channel_train.pt efficientnet
    deps:
    - path: data/processed/train_data_3channel_train.pt
      hash: md5
      md5: a3c4c62ecdcc6e8086e55e5c2ff08af5
      size: 401804970
    - path: pipelines/src/train.py
      hash: md5
      md5: e91dd00e1696b3bbb90f29a63a186096
      size: 5860
    outs:
    - path: data/model/runs/efficientnet.pth
      hash: md5
      md5: 1426f19c6b415ac09c648774c33e929e
      size: 16375038
  train_mobilenet:
    cmd: python pipelines/src/train.py train_data_3channel_train.pt mobilenet
    deps:
    - path: data/processed/train_data_3channel_train.pt
      hash: md5
      md5: a3c4c62ecdcc6e8086e55e5c2ff08af5
      size: 401804970
    - path: pipelines/src/train.py
      hash: md5
      md5: e91dd00e1696b3bbb90f29a63a186096
      size: 5860
    outs:
    - path: data/model/runs/mobilenet.pth
      hash: md5
      md5: ac8ec0a99d01a281ba3fb72816c7ae38
      size: 9182266
  evaluate_vgg16:
    cmd: python pipelines/src/evaluate.py train_data_3channel_test.pt vgg16.pth metrics_vgg16.pkl
      conf_matrix_vgg16.pkl
    deps:
    - path: data/model/runs/vgg16.pth
      hash: md5
      md5: af9a0a29fbf2982767e552886e398aa7
      size: 537182638
    - path: data/processed/train_data_3channel_test.pt
      hash: md5
      md5: 7565ee1089643a12568efd5b59ffc028
      size: 100601791
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0cfa9bd89ae4b8cf3794ae153d0145ec
      size: 6449
    outs:
    - path: data/processed/conf_matrix_vgg16.pkl
      hash: md5
      md5: 88083ccd230633dbfb163ae35ba33556
      size: 664
    - path: data/processed/metrics_vgg16.pkl
      hash: md5
      md5: a3598b4741ad7d558ad2dd857a99343f
      size: 1831
  evaluate_resnet:
    cmd: python pipelines/src/evaluate.py train_data_3channel_test.pt resnet18.pth
      metrics_resnet.csv conf_matrix_resnet.pkl
    deps:
    - path: data/model/runs/resnet18.pth
      hash: md5
      md5: 01b88ed4fbc1155c359d9f149856a065
      size: 44801020
    - path: data/processed/train_data_3channel_test.pt
      hash: md5
      md5: 7565ee1089643a12568efd5b59ffc028
      size: 100601791
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0b6d3789102273802e65d570587e6588
      size: 3683
    outs:
    - path: data/processed/conf_matrix_resnet.pkl
      hash: md5
      md5: 4612a1ba0568351cfdcd5d83ef07f20c
      size: 664
    - path: data/processed/metrics_resnet.csv
      hash: md5
      md5: f4fe2bc6b18b5ea84741685060a24d1e
      size: 458
  evaluate_vit:
    cmd: python pipelines/src/evaluate.py train_data_3channel_test.pt vit.pth metrics_vit.pkl
      conf_matrix_vit.pkl
    deps:
    - path: data/model/runs/vit.pth
      hash: md5
      md5: da97b99889bc7fc0bed7adfbd7356c26
      size: 343268370
    - path: data/processed/train_data_3channel_test.pt
      hash: md5
      md5: 7565ee1089643a12568efd5b59ffc028
      size: 100601791
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0cfa9bd89ae4b8cf3794ae153d0145ec
      size: 6449
    outs:
    - path: data/processed/conf_matrix_vit.pkl
      hash: md5
      md5: c0051994d89042a4e000e60433f1b257
      size: 664
    - path: data/processed/metrics_vit.pkl
      hash: md5
      md5: 4e4670ea66f7f09a63249227d4d61cf7
      size: 1831
  evaluate_efficientnet:
    cmd: python pipelines/src/evaluate.py train_data_3channel_test.pt efficientnet.pth
      metrics_efficientnet.pkl conf_matrix_efficientnet.pkl
    deps:
    - path: data/model/runs/efficientnet.pth
      hash: md5
      md5: 1426f19c6b415ac09c648774c33e929e
      size: 16375038
    - path: data/processed/train_data_3channel_test.pt
      hash: md5
      md5: 7565ee1089643a12568efd5b59ffc028
      size: 100601791
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0cfa9bd89ae4b8cf3794ae153d0145ec
      size: 6449
    outs:
    - path: data/processed/conf_matrix_efficientnet.pkl
      hash: md5
      md5: bf97f284d0033a2f451a2c69e866fa97
      size: 664
    - path: data/processed/metrics_efficientnet.pkl
      hash: md5
      md5: b49136531a2b859a12f7e51175285ea4
      size: 1831
  evaluate_mobilenet:
    cmd: python pipelines/src/evaluate.py train_data_3channel_test.pt mobilenet.pth
      metrics_mobilenet.pkl conf_matrix_mobilenet.pkl
    deps:
    - path: data/model/runs/mobilenet.pth
      hash: md5
      md5: ac8ec0a99d01a281ba3fb72816c7ae38
      size: 9182266
    - path: data/processed/train_data_3channel_test.pt
      hash: md5
      md5: 7565ee1089643a12568efd5b59ffc028
      size: 100601791
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0cfa9bd89ae4b8cf3794ae153d0145ec
      size: 6449
    outs:
    - path: data/processed/conf_matrix_mobilenet.pkl
      hash: md5
      md5: deccde57e6f0450912f4029d2a6171bf
      size: 664
    - path: data/processed/metrics_mobilenet.pkl
      hash: md5
      md5: 500109d3c06ace77e7bf58ca52b720fb
      size: 1831
  train_custom_cnn:
    cmd: python pipelines/src/train.py train_data_2channel_train.pt custom_cnn
    deps:
    - path: data/processed/train_data_2channel_train.pt
      hash: md5
      md5: 23476c00da28709c76137423c1a93ac6
      size: 267935402
    - path: pipelines/src/train.py
      hash: md5
      md5: e91dd00e1696b3bbb90f29a63a186096
      size: 5860
    params:
      params.yaml:
        models.custom_cnn:
          in_channels: 2
          channel1: 32
          channel2: 64
          out_features: 8
        training.epochs: 15
    outs:
    - path: data/model/runs/custom_cnn.pth
      hash: md5
      md5: 467a443e99ef11ac1b945f69b247b3cf
      size: 6696226
  train_mlp:
    cmd: python pipelines/src/train.py train_data_2channel_train.pt mlp
    deps:
    - path: data/processed/train_data_2channel_train.pt
      hash: md5
      md5: 23476c00da28709c76137423c1a93ac6
      size: 267935402
    - path: pipelines/src/train.py
      hash: md5
      md5: e91dd00e1696b3bbb90f29a63a186096
      size: 5860
    params:
      params.yaml:
        models.mlp:
          in_channels: 2
          patch_size: 16
          hidden_dim: 256
          num_layers: 3
          num_classes: 8
        training.epochs: 15
    outs:
    - path: data/model/runs/mlp.pth
      hash: md5
      md5: b695a1c24c609269d61d5d4403e3af97
      size: 8452382
  train_deep_capsule:
    cmd: python pipelines/src/train.py train_data_2channel_train.pt deep_capsule
    deps:
    - path: data/processed/train_data_2channel_train.pt
      hash: md5
      md5: 23476c00da28709c76137423c1a93ac6
      size: 267935402
    - path: pipelines/src/train.py
      hash: md5
      md5: e91dd00e1696b3bbb90f29a63a186096
      size: 5860
    params:
      params.yaml:
        models.deep_capsule:
          in_channels: 2
          conv1_out: 32
          conv2_out: 64
          capsule_dim: 8
          num_capsules: 32
          num_classes: 8
        training.epochs: 15
    outs:
    - path: data/model/runs/deep_capsule.pth
      hash: md5
      md5: dcd7492723886f0555f71e9ab5ad6e15
      size: 1534348604
  train_capsule:
    cmd: python pipelines/src/train.py train_data_2channel_train.pt capsule
    deps:
    - path: data/processed/train_data_2channel_train.pt
      hash: md5
      md5: 23476c00da28709c76137423c1a93ac6
      size: 267935402
    - path: pipelines/src/train.py
      hash: md5
      md5: e91dd00e1696b3bbb90f29a63a186096
      size: 5860
    params:
      params.yaml:
        models.capsule:
          in_channels: 2
          conv_out: 256
          capsule_dim: 8
          num_capsules: 32
          num_classes: 8
        training.epochs: 15
    outs:
    - path: data/model/runs/capsule.pth
      hash: md5
      md5: 0fa7331c08eaf7dc1fa623be75b4b854
      size: 1439079240
  train_resnet18:
    cmd: python pipelines/src/train.py train_data_3channel_train.pt resnet18
    deps:
    - path: data/processed/train_data_3channel_train.pt
      hash: md5
      md5: a3c4c62ecdcc6e8086e55e5c2ff08af5
      size: 401804970
    - path: pipelines/src/train.py
      hash: md5
      md5: e91dd00e1696b3bbb90f29a63a186096
      size: 5860
    outs:
    - path: data/model/runs/resnet18.pth
      hash: md5
      md5: 966b45054f468d3d863bb939aa1803ed
      size: 44801020
  evaluate_custom_cnn:
    cmd: python pipelines/src/evaluate.py train_data_2channel_test.pt custom_cnn.pth
      metrics_custom_cnn.pkl conf_matrix_custom_cnn.pkl
    deps:
    - path: data/model/runs/custom_cnn.pth
      hash: md5
      md5: 467a443e99ef11ac1b945f69b247b3cf
      size: 6696226
    - path: data/processed/train_data_2channel_test.pt
      hash: md5
      md5: cf583befd4f970dd82c936989c92a884
      size: 67084223
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0cfa9bd89ae4b8cf3794ae153d0145ec
      size: 6449
    params:
      params.yaml:
        models.custom_cnn:
          in_channels: 2
          channel1: 32
          channel2: 64
          out_features: 8
    outs:
    - path: data/processed/conf_matrix_custom_cnn.pkl
      hash: md5
      md5: 9e097cc40623b4e6532e9163a8c60394
      size: 664
    - path: data/processed/metrics_custom_cnn.pkl
      hash: md5
      md5: 04a36eb45387967cc40cd6d55f31a7e6
      size: 1831
  evaluate_mlp:
    cmd: python pipelines/src/evaluate.py train_data_2channel_test.pt mlp.pth metrics_mlp.pkl
      conf_matrix_mlp.pkl
    deps:
    - path: data/model/runs/mlp.pth
      hash: md5
      md5: b695a1c24c609269d61d5d4403e3af97
      size: 8452382
    - path: data/processed/train_data_2channel_test.pt
      hash: md5
      md5: cf583befd4f970dd82c936989c92a884
      size: 67084223
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0cfa9bd89ae4b8cf3794ae153d0145ec
      size: 6449
    params:
      params.yaml:
        models.mlp:
          in_channels: 2
          patch_size: 16
          hidden_dim: 256
          num_layers: 3
          num_classes: 8
    outs:
    - path: data/processed/conf_matrix_mlp.pkl
      hash: md5
      md5: 37368ecf3061a8425d1d8eddaa76bf16
      size: 664
    - path: data/processed/metrics_mlp.pkl
      hash: md5
      md5: 86d27e82813be7c02c5c2bd8efbe7b5f
      size: 1831
  evaluate_deep_capsule:
    cmd: python pipelines/src/evaluate.py train_data_2channel_test.pt deep_capsule.pth
      metrics_deep_capsule.pkl conf_matrix_deep_capsule.pkl
    deps:
    - path: data/model/runs/deep_capsule.pth
      hash: md5
      md5: dcd7492723886f0555f71e9ab5ad6e15
      size: 1534348604
    - path: data/processed/train_data_2channel_test.pt
      hash: md5
      md5: cf583befd4f970dd82c936989c92a884
      size: 67084223
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0cfa9bd89ae4b8cf3794ae153d0145ec
      size: 6449
    params:
      params.yaml:
        models.deep_capsule:
          in_channels: 2
          conv1_out: 32
          conv2_out: 64
          capsule_dim: 8
          num_capsules: 32
          num_classes: 8
    outs:
    - path: data/processed/conf_matrix_deep_capsule.pkl
      hash: md5
      md5: e6ffce91945076693dfaaff73396e50f
      size: 664
    - path: data/processed/metrics_deep_capsule.pkl
      hash: md5
      md5: 09765fbcf5b46b569b48a99b3865be11
      size: 1831
  evaluate_capsule:
    cmd: python pipelines/src/evaluate.py train_data_2channel_test.pt capsule.pth
      metrics_capsule.pkl conf_matrix_capsule.pkl
    deps:
    - path: data/model/runs/capsule.pth
      hash: md5
      md5: 0fa7331c08eaf7dc1fa623be75b4b854
      size: 1439079240
    - path: data/processed/train_data_2channel_test.pt
      hash: md5
      md5: cf583befd4f970dd82c936989c92a884
      size: 67084223
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0cfa9bd89ae4b8cf3794ae153d0145ec
      size: 6449
    params:
      params.yaml:
        models.capsule:
          in_channels: 2
          conv_out: 256
          capsule_dim: 8
          num_capsules: 32
          num_classes: 8
    outs:
    - path: data/processed/conf_matrix_capsule.pkl
      hash: md5
      md5: 78e2da8964e4290c1e327a075c96642c
      size: 664
    - path: data/processed/metrics_capsule.pkl
      hash: md5
      md5: 2902089144a71b37a6fb08dc77684493
      size: 1831
  evaluate_resnet18:
    cmd: python pipelines/src/evaluate.py train_data_3channel_test.pt resnet18.pth
      metrics_resnet18.pkl conf_matrix_resnet18.pkl
    deps:
    - path: data/model/runs/resnet18.pth
      hash: md5
      md5: 966b45054f468d3d863bb939aa1803ed
      size: 44801020
    - path: data/processed/train_data_3channel_test.pt
      hash: md5
      md5: 7565ee1089643a12568efd5b59ffc028
      size: 100601791
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0cfa9bd89ae4b8cf3794ae153d0145ec
      size: 6449
    outs:
    - path: data/processed/conf_matrix_resnet18.pkl
      hash: md5
      md5: 5c6e3878bdcfe461e1ae1c422edac5c3
      size: 664
    - path: data/processed/metrics_resnet18.pkl
      hash: md5
      md5: 0e3b39ebc8ff6d9ba9c07ed47ce75806
      size: 1831
  train_dense:
    cmd: python pipelines/src/train.py train_data_2channel_train.pt dense
    deps:
    - path: data/processed/train_data_2channel_train.pt
      hash: md5
      md5: 23476c00da28709c76137423c1a93ac6
      size: 267935402
    - path: pipelines/src/train.py
      hash: md5
      md5: e91dd00e1696b3bbb90f29a63a186096
      size: 5860
    params:
      params.yaml:
        models.dense:
          in_channels: 2
          growth_rate: 16
          num_layers: 12
          out_features: 8
          epochs: 30
    outs:
    - path: data/model/runs/dense.pth
      hash: md5
      md5: 91db6392eca70dd0b1651add521eddad
      size: 887166
  train_densenet:
    cmd: python pipelines/src/train.py train_data_2channel_train.pt densenet
    deps:
    - path: data/processed/train_data_2channel_train.pt
      hash: md5
      md5: 23476c00da28709c76137423c1a93ac6
      size: 267935402
    - path: pipelines/src/train.py
      hash: md5
      md5: e91dd00e1696b3bbb90f29a63a186096
      size: 5860
    params:
      params.yaml:
        models.densenet:
          in_channels: 2
          growth_rate: 24
          num_layers: 12
          out_features: 8
          reduction: 0.2
          drop_rate: 0.0
          epochs: 30
    outs:
    - path: data/model/runs/densenet.pth
      hash: md5
      md5: ddbcc34d3c02b38843c5b945cbc61418
      size: 802466
  evaluate_dense:
    cmd: python pipelines/src/evaluate.py train_data_2channel_test.pt dense.pth metrics_dense.pkl
      conf_matrix_dense.pkl
    deps:
    - path: data/model/runs/dense.pth
      hash: md5
      md5: 91db6392eca70dd0b1651add521eddad
      size: 887166
    - path: data/processed/train_data_2channel_test.pt
      hash: md5
      md5: cf583befd4f970dd82c936989c92a884
      size: 67084223
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0cfa9bd89ae4b8cf3794ae153d0145ec
      size: 6449
    params:
      params.yaml:
        models.dense:
          in_channels: 2
          growth_rate: 16
          num_layers: 12
          out_features: 8
          epochs: 30
    outs:
    - path: data/processed/conf_matrix_dense.pkl
      hash: md5
      md5: a5b4d6f2350a62c78ffa5d99d943c2bc
      size: 664
    - path: data/processed/metrics_dense.pkl
      hash: md5
      md5: 44869b1ef5c599a9cd307e40fc75d615
      size: 1831
  evaluate_densenet:
    cmd: python pipelines/src/evaluate.py train_data_2channel_test.pt densenet.pth
      metrics_densenet.pkl conf_matrix_densenet.pkl
    deps:
    - path: data/model/runs/densenet.pth
      hash: md5
      md5: ddbcc34d3c02b38843c5b945cbc61418
      size: 802466
    - path: data/processed/train_data_2channel_test.pt
      hash: md5
      md5: cf583befd4f970dd82c936989c92a884
      size: 67084223
    - path: pipelines/src/evaluate.py
      hash: md5
      md5: 0cfa9bd89ae4b8cf3794ae153d0145ec
      size: 6449
    params:
      params.yaml:
        models.densenet:
          in_channels: 2
          growth_rate: 24
          num_layers: 12
          out_features: 8
          reduction: 0.2
          drop_rate: 0.0
          epochs: 30
    outs:
    - path: data/processed/conf_matrix_densenet.pkl
      hash: md5
      md5: 1fafc4c67bd1ad645260aee14718d14d
      size: 664
    - path: data/processed/metrics_densenet.pkl
      hash: md5
      md5: b165f17e674881928ba2ab244ecc51c8
      size: 1831
